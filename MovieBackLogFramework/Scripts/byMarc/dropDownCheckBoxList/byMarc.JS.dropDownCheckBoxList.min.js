function byMarc_ddcbl_refresh(n){var i="",h="",p="",c="",r,t,v,u,f;n.selectedCount=0;var s=!0,l=!0,a=n.selectListItems.length;for(r=0;r<a;r++)t=n.selectListItems[r],v=t.checkBoxElement,v.checked?(i+=h+t.Text.toString(),n.selectedCount+=1,t.Disabled||(l=!1),p+=c+t.Value.toString(),h=", ",c=","):t.Disabled||(s=!1);u=n.selectedCount===a;f=n.selectedCount===0;n.fixedHeaderText!==null?i=n.fixedHeaderText:(f&&n.noSelectionsText!==null&&(i=n.noSelectionsText),u&&n.allSelectionsText!==null&&(i=n.allSelectionsText));n.displayElement.innerText=i;n.selectAllElement.indeterminate=!s&&!l;n.selectAllElement.checked=s;n.okButtonElement.className="byMarc-ddcbl-command"+(byMarc_ddcbl_isOk(n)?"":" byMarc-ddcbl-command-disabled");var e=n.isCollapsed?"collapsed":"expanded",y=u?"all":f?"none":"some",o=u?["notNone","notSome"]:f?["notAll","notSome"]:["notAll","notNone"];n.buttonElement.className="byMarc-ddcbl-button byMarc-ddcbl-button-"+e+" byMarc-ddcbl-button-"+y+" byMarc-ddcbl-button-"+e+"-"+y+" byMarc-ddcbl-button-"+o[0]+" byMarc-ddcbl-button-"+o[1]+" byMarc-ddcbl-button-"+e+"-"+o[0]+" byMarc-ddcbl-button-"+e+"-"+o[1]}function byMarc_ddcbl_cancel(n){var t,i;if(!n.isCollapsed){for(t=0;t<n.selectListItems.length;t++)i=n.selectListItems[t],i.checkBoxElement.checked=i.lastChecked;byMarc_ddcbl_refresh(n);byMarc_ddcbl_collapse(n)}}function byMarc_ddcbl_selectAll(n){for(i=0;i<n.selectListItems.length;i++){var t=n.selectListItems[i];t.Disabled||(t.checkBoxElement.checked=n.selectAllElement.checked)}byMarc_ddcbl_refresh(n)}function byMarc_ddcbl_toggleDropDown(n){n.isCollapsed?byMarc_ddcbl_expand(n):byMarc_ddcbl_collapse(n)}function byMarc_ddcbl_expand(n){n.dropDownElement.style.display="inherit";n.isCollapsed=!1;byMarc_ddcbl_refresh(n)}function byMarc_ddcbl_collapse(n){n.dropDownElement.style.display="none";n.isCollapsed=!0;byMarc_ddcbl_refresh(n)}function byMarc_ddcbl_isDescendant(n,t){for(var i=t;i!==null;){if(i===n)return!0;i=i.parentNode}return!1}function byMarc_ddcbl_onload(n){byMarc_ddcbl_refresh(n);document.addEventListener("click",function(t){var i=document.elementFromPoint(t.clientX,t.clientY);byMarc_ddcbl_isDescendant(n.parentElement,i)||byMarc_ddcbl_cancel(n)})}function byMarc_ddcbl_isOk(n){return n.selectedCount>=n.minSelections&&(n.maxSelections===null||n.selectedCount<=n.maxSelections)}function byMarc_ddcbl_ok(n){var t,i;if(byMarc_ddcbl_isOk(n)){for(t=0;t<n.selectListItems.length;t++)i=n.selectListItems[t],i.lastChecked=i.checkBoxElement.checked;byMarc_ddcbl_collapse(n);eval(n.onOkClick)}}function createDropDownCheckBoxList(n){var h,c,l,u,f,v,e,s,t,y,r,i;(n.name===undefined||typeof n.name!="string")&&(n.name=null);n.noSelectionsText!==null&&typeof n.noSelectionsText!="string"&&(n.noSelectionsText=null);n.allSelectionsText!==null&&typeof n.allSelectionsText!="string"&&(n.allSelectionsText=null);n.fixedHeaderText!==null&&typeof n.fixedHeaderText!="string"&&(n.fixedHeaderText=null);(n.autoSort===null||typeof n.autoSort!="boolean")&&(n.autoSort=!1);(n.minSelections===null||typeof n.minSelections!="number")&&(n.minSelections=0);n.maxSelections!==null&&typeof n.maxSelections!="number"&&(n.maxSelections=null);n.selectListItems!==null&&typeof n.selectListItems!="object"&&(n.selectListItems=[]);n.isCollapsed=!0;n.element=document.createElement("table");n.element.cellSpacing=0;n.element.cellPadding=0;n.element.className="byMarc-ddcbl-table";h=n.element.insertRow(-1);h.className="byMarc-ddcbl-inputbox";c=h.insertCell(-1);l=document.createElement("div");l.className="byMarc-ddcbl-displayDiv";c.appendChild(l);n.displayElement=document.createElement("span");l.appendChild(n.displayElement);n.displayElement.className="byMarc-ddcbl-input";n.buttonElement=h.insertCell(-1);n.buttonElement.onclick=function(){byMarc_ddcbl_toggleDropDown(n)};n.dropDownElement=n.element.insertRow(-1);n.dropDownElement.style.display="none";c=n.dropDownElement.insertCell(-1);u=document.createElement("table");c.appendChild(u);u.className="byMarc-ddcbl-dropdown";u.cellSpacing=0;u.cellPadding=0;var a=u.insertRow(-1),o=a.insertCell(-1),p=document.createElement("div");for(o.appendChild(p),p.className="byMarc-ddcbl-scrollDiv",f=document.createElement("table"),p.appendChild(f),f.cellPadding=0,f.cellSpacing=0,v=f.insertRow(-1),v.className="byMarc-ddcbl-itemRow",e=v.insertCell(-1),e.className="byMarc-ddcbl-item",n.selectAllElement=document.createElement("input"),n.selectAllElement.type="checkbox",n.selectAllElement.onclick=function(){byMarc_ddcbl_selectAll(n)},n.selectAllElement.className="byMarc-ddcbl-checkbox",e.appendChild(n.selectAllElement),e=v.insertCell(-1),e.className="byMarc-ddcbl-itemlabel",e.innerText="(Select All)",n.autoSort&&n.selectListItems.sort(function(n,t){var i=n.Text.toUpperCase(),r=t.Text.toUpperCase();return i<r?-1:i>r?1:0}),s=0;s<n.selectListItems.length;s++)t=n.selectListItems[s],(t.Value===undefined||t.Value===null)&&(t.Value=""),y=f.insertRow(-1),y.className="byMarc-ddcbl-itemRow",r=y.insertCell(-1),r.className="byMarc-ddcbl-item",i=document.createElement("input"),i.type="checkbox",i.onclick=function(){byMarc_ddcbl_refresh(n)},i.value=t.Value.toString(),i.className="byMarc-ddcbl-checkbox",t.Disabled&&(i.className+=" byMarc-ddcbl-checkbox-disabled"),i.checked=t.Selected,n.name!==null&&(i.name=n.name),i.disabled=t.Disabled,t.checkBoxElement=i,t.lastChecked=t.Selected,r.appendChild(i),r=y.insertCell(-1),r.innerText=t.Text.toString(),r.setAttribute("index",s),t.Disabled||(r.onclick=function(){var i=this.getAttribute("index"),t=n.selectListItems[i].checkBoxElement;t.checked=!t.checked;byMarc_ddcbl_refresh(n)}),r.className="byMarc-ddcbl-itemlabel",t.Disabled&&(r.className+=" byMarc-ddcbl-itemlabel-disabled");return a=u.insertRow(-1),a.className="byMarc-ddcbl-commandsTableRow",o=a.insertCell(-1),o.className="byMarc-ddcbl-commandsTableCell",n.okButtonElement=document.createElement("a"),n.okButtonElement.href="javascript: void();",n.okButtonElement.onclick=function(){byMarc_ddcbl_ok(n)},n.okButtonElement.className="byMarc-ddcbl-command",n.okButtonElement.innerHTML="Ok",o.appendChild(n.okButtonElement),n.cancelButtonElement=document.createElement("a"),n.cancelButtonElement.href="javascript: void();",n.cancelButtonElement.onclick=function(){byMarc_ddcbl_cancel(n)},n.cancelButtonElement.className="byMarc-ddcbl-command",n.cancelButtonElement.innerHTML="Cancel",o.appendChild(n.cancelButtonElement),n.parentElement!==null&&(typeof n.parentElement=="string"&&(n.parentElement=document.getElementById(n.parentElement)),typeof n.parentElement=="object"&&n.parentElement.appendChild(n.element)),window.addEventListener("load",byMarc_ddcbl_onload(n)),n.element}